---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import MainLayout from '../../layouts/MainLayout.astro';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<MainLayout title="Insights & Analysis">
	<section class="py-40 border-b border-white/5 bg-grid">
		<div class="container-premium">
			<span class="text-brand-accent text-xs font-bold uppercase tracking-[0.5em] mb-8 block">Intellectual Capital</span>
			<h1 class="text-6xl md:text-9xl font-display font-bold mb-12 leading-[0.8] tracking-tighter uppercase">
				THE <span class="text-white/20 italic">INSIGHTS</span>
			</h1>
			<p class="text-white/40 max-w-2xl text-xl leading-relaxed font-light">
				Strategic analysis on corporate excellence, regeneration trends, and the future of London's business landscape.
			</p>
		</div>
	</section>

	<section class="py-32">
		<div class="container-premium">
			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-16 lg:gap-24">
				{posts.map((post) => (
					<article class="group relative flex flex-col">
						<a href={`/blog/${post.id}/`} class="block overflow-hidden bg-brand-secondary border border-white/5 aspect-[16/10] mb-10 relative">
							{post.data.heroImage && (
								<Image 
									width={800} 
									height={500} 
									src={post.data.heroImage} 
									alt={post.data.title} 
									class="w-full h-full object-cover grayscale group-hover:grayscale-0 group-hover:scale-110 transition-all duration-1000 opacity-40 group-hover:opacity-100"
								/>
							)}
							<div class="absolute inset-0 bg-gradient-to-t from-brand-primary/80 via-transparent to-transparent"></div>
						</a>
						
						<div class="flex items-center gap-3 text-[9px] font-bold uppercase tracking-[0.4em] text-brand-accent mb-6">
							<div class="h-[1px] w-8 bg-current"></div>
							<FormattedDate date={post.data.pubDate} />
						</div>

						<h3 class="text-2xl md:text-3xl font-display font-bold mb-6 uppercase tracking-tight group-hover:text-brand-accent transition-colors duration-500 leading-tight">
							<a href={`/blog/${post.id}/`}>{post.data.title}</a>
						</h3>
						
						<p class="text-white/30 text-sm leading-relaxed mb-10 line-clamp-3 font-light">
							{post.data.description}
						</p>

						<div class="mt-auto pt-8 border-t border-white/5">
							<a href={`/blog/${post.id}/`} class="text-[10px] font-bold uppercase tracking-[0.5em] text-white hover:text-brand-accent transition-all">
								Read Analysis â†’
							</a>
						</div>
					</article>
				))}
			</div>
		</div>
	</section>
</MainLayout>
